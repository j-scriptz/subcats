<?php
/** @var \Jscriptz\Subcats\Block\Subcats $block */
/** @var $escaper \Laminas\View\Helper\Escaper */
$canShow  = $block->canShowSubcategories();
$children = $block->getChildCategories();

if (!$canShow || !$children) {
    return;
}

$title     = $block->getBlockTitle();
$growClass = $block->isGrowEnabled() ? 'jscriptz-subcats__item--grow' : '';
$presetClass = $block->getDesignPresetCssClass();
?>
<div class="block jscriptz-subcats <?= $escaper->escapeHtmlAttr($presetClass) ?>">
    <?php if ($title): ?>
        <div class="block-title">
            <strong><?= $block->escapeHtml($title) ?></strong>
        </div>
    <?php endif; ?>

    <div class="jscriptz-subcats__list">
        <?php foreach ($children as $child): ?>
            <?php
            /** @var \Magento\Catalog\Model\Category $child */
            $imageUrl    = $block->getSubcategoryImageUrl($child);
            $description = $block->getSubcategoryDescription($child);

            $itemClasses = 'jscriptz-subcats__item';
            if ($growClass) {
                $itemClasses .= ' ' . $growClass;
            }
            ?>
            <div class="<?= $escaper->escapeHtmlAttr($itemClasses) ?>">
                <a class="jscriptz-subcats__image-link"
                   href="<?= $escaper->escapeUrl($child->getUrl()) ?>">
                    <span class="jscriptz-subcats__media-wrapper">
                        <?php if ($imageUrl): ?>
                            <img class="jscriptz-subcats__image"
                                 src="<?= $escaper->escapeUrl($imageUrl) ?>"
                                 alt="<?= $escaper->escapeHtmlAttr($child->getName()) ?>" />
                        <?php endif; ?>
                    </span>
                </a>

                <div class="jscriptz-subcats__content">
                    <h3 class="jscriptz-subcats__name">
                        <a class="jscriptz-subcats__link"
                           href="<?= $escaper->escapeUrl($child->getUrl()) ?>">
                            <?= $escaper->escapeHtml($child->getName()) ?>
                        </a>
                    </h3>
                </div>
            </div>
        <?php endforeach; ?>
    </div>
</div>
